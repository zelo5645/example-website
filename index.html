<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø£Ù†Ø§ Ø§ØªØ¨Ø¶Ù†Øª â€“ Ø¨Ø§Ø±ÙƒÙˆØ± Ø¯ÙŠÙ†Ùˆ</title>
  <style>
    :root{--bg1:#bcd8ff;--bg2:#eef6ff;--road:#e6e6e6;--shadow:rgba(0,0,0,.12);--text:#222;--muted:#666;--accent:#007bff}
    *{box-sizing:border-box}
    body{margin:0;overflow:hidden;background:linear-gradient(to bottom,var(--bg1) 0%,var(--bg2) 60%,#fff 100%);font-family:'Cairo',system-ui,Segoe UI,Roboto,Arial,'Noto Sans Arabic',sans-serif;color:var(--text)}
    canvas{display:block;width:100vw;height:100vh}
    #startOverlay,#gameOverOverlay{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;background:rgba(255,255,255,.7);backdrop-filter:blur(8px)}
    #gameOverOverlay{display:none}
    h1{margin:0 0 6px 0}
    .btn{font-size:1.05rem;padding:10px 18px;border:none;border-radius:12px;background:var(--accent);color:#fff;cursor:pointer}
    .btn:hover{filter:brightness(.95)}
    .dialog{min-width:min(92vw,420px);padding:16px 18px;border-radius:16px;background:rgba(120,120,120,.25);border:1px solid rgba(0,0,0,.12);box-shadow:0 10px 30px rgba(0,0,0,.15);text-align:center}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <canvas id="game"></canvas>

  <div id="startOverlay">
    <div class="dialog">
      <h1>ğŸƒâ€â™‚ï¸ Ù„Ø¹Ø¨Ø© Ø£Ù†Ø§ Ø§ØªØ¨Ø¶Ù†Øª</h1>
      <p class="muted">Ø·ÙŠØ²Ùƒ Ø­Ù…Ø±Ù‡ ÙŠØ¹Ø¨Ø¯Ù„Ù„Ù‡ Ø§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£ Ø«Ù… Ø§Ù‚ÙØ² Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª Ø©.</p>
      <button id="startBtn" class="btn">Ø§Ø¨Ø¯Ø£</button>
    </div>
  </div>

  <div id="gameOverOverlay">
    <div class="dialog">
      <h2 style="margin:0">ğŸ’¬ Ø£Ù†Ø§ Ø§ØªØ¨Ø¶Ù†Øª!</h2>
      <p id="distanceText" class="muted" style="margin:6px 0 12px">Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„ØªÙŠ Ù‚Ø·Ø¹ØªÙ‡Ø§: 0 Ù…ØªØ±</p>
      <button id="okBtn" class="btn">OK</button>
    </div>
  </div>

  <script>
    const canvas=document.getElementById('game');
    const ctx=canvas.getContext('2d');
    function resize(){canvas.width=innerWidth;canvas.height=innerHeight} window.addEventListener('resize',resize); resize();

    // ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© =====
    const groundH=76;
    const world={speed:3, accel:0.0009, maxSpeed:7}; // Ø£Ø³Ù‡Ù„: Ø³Ø±Ø¹Ø© Ø¨Ø·ÙŠØ¦Ø© ÙˆØ²ÙŠØ§Ø¯Ø© ØªØ¯Ø±ÙŠØ¬ÙŠØ© Ø®ÙÙŠÙØ©
    const gravity=1.35; // Ø¬Ø§Ø°Ø¨ÙŠØ© Ù…Ø±ÙŠØ­Ø©
    const jumpV=-21; // Ù‚ÙØ² Ø£Ø¹Ù„Ù‰ Ø´ÙˆÙŠØ© Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ®Ø·Ù‘ÙŠ

    const player={x:110,y:0,w:60,h:60,vy:0,onGround:true,dead:false,angle:0};
    const face=new Image();
    face.src='https://i.ibb.co/dwTZjPhN/Whats-App-Image-2025-10-20-at-16-49-55-fcee5338.jpg';

    let obstacles=[]; let last=0; let score=0; let state='start'; let deathTime=0;

    // ===== Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ© (Base64) =====
    const music=new Audio('data:audio/mp3;base64,SUQzBAAAAAABAFRYWFgAAAASAAADbWFqb3JfYnJhbmQAZGFzaABUWFhYAAAAEQAAA21pbm9yX3ZlcnNpb24AMABUWFhYAAAAHAAAA2NvbXBhdGlibGVfYnJhbmRzAGlzbzZtcDQxAFRTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');
    music.loop=true; music.volume=0.32;

    // ===== Ù…Ø¤Ø«Ø±Ø§Øª ØµÙˆØªÙŠØ© Ø¨Ø³ÙŠØ·Ø© (Ù‚ÙØ²/Ù…ÙˆØª) Ø¨Ø§Ù„ÙˆÙŠØ¨ Ø£ÙˆØ¯ÙŠÙˆ =====
    let ac=null; function tone(f=700,ms=80,type='square',vol=0.03){ if(!ac) ac=new (window.AudioContext||window.webkitAudioContext)(); const o=ac.createOscillator(); const g=ac.createGain(); o.type=type; o.frequency.value=f; g.gain.value=vol; o.connect(g); g.connect(ac.destination); o.start(); setTimeout(()=>o.stop(), ms); }
    function sfxJump(){ tone(760,70,'triangle',0.025); }
    function sfxDeath(){ tone(200,160,'sawtooth',0.035); setTimeout(()=>tone(140,160,'sine',0.03),120); }

    // ===== ØªØ­ÙƒÙ… =====
    function jump(){ if(state!=='play' || player.dead) return; if(player.onGround){ player.vy=jumpV; player.onGround=false; sfxJump(); } }
    addEventListener('keydown',e=>{ if(e.code==='Space'){ e.preventDefault(); jump(); } });
    canvas.addEventListener('pointerdown', jump);

    // ===== ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª (Ø³Ù‡Ù„) =====
    let spawnTimer=0; function spawnObstacle(){
      const minGap = 220; const maxGap = 360; // Ù…Ø³Ø§ÙØ§Øª Ø£ÙˆØ³Ø¹
      const h = 36 + Math.random()*28; const w = 28 + Math.random()*28; // Ø£Ø­Ø¬Ø§Ù… Ù…Ø±ÙŠØ­Ø©
      const lastX = obstacles.length? obstacles[obstacles.length-1].x : canvas.width+60;
      const gap = minGap + Math.random()*(maxGap-minGap);
      obstacles.push({x: Math.max(canvas.width+60, lastX + gap), y: canvas.height-groundH-h, w, h});
    }

    // ===== Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ =====
    function reset(){
      world.speed=3; score=0; obstacles.length=0; player.y=canvas.height-groundH-player.h; player.vy=0; player.onGround=true; player.dead=false; player.angle=0; deathTime=0;
    }

    // ===== ØªØ³ÙŠÙŠØ± Ø§Ù„Ø¹Ø§Ù„Ù… =====
    function update(dt){
      if(state!=='play') return;
      // Ø³Ø±Ø¹Ø© ØªØ²Ø¯Ø§Ø¯ Ø¨Ù‡Ø¯ÙˆØ¡
      world.speed = Math.min(world.maxSpeed, world.speed + world.accel * dt * 60);

      // ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨
      player.vy += gravity; player.y += player.vy;
      const floorY = canvas.height - groundH - player.h;
      if(player.y >= floorY){ player.y=floorY; player.vy=0; player.onGround=true; }

      // Ø¹Ù‚Ø¨Ø§Øª
      if(obstacles.length===0 || obstacles[obstacles.length-1].x < canvas.width - 280){ spawnObstacle(); }
      for(let i=obstacles.length-1;i>=0;i--){ const o=obstacles[i]; o.x -= world.speed; if(o.x+o.w < -20) obstacles.splice(i,1); }

      // ØªØµØ§Ø¯Ù…
      for(const o of obstacles){ if(rectOverlap(player.x,player.y,player.w,player.h, o.x,o.y,o.w,o.h)) { die(); break; } }

      // Ù†ØªÙŠØ¬Ø©
      score += world.speed * dt * 0.6; // Ù…Ù‚ÙŠØ§Ø³ ØªÙ‚Ø±ÙŠØ¨ÙŠ Ø¨Ø§Ù„Ù…ØªØ±

      // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù…ÙˆØª
      if(player.dead){ player.angle += 0.22; if(player.y < floorY) player.vy += gravity*0.6; else player.vy=0; }
    }

    function die(){ if(player.dead) return; player.dead=true; sfxDeath(); music.pause(); deathTime=performance.now(); setTimeout(showGameOver, 520); }

    function showGameOver(){ if(state!=='play') return; state='over'; const d=document.getElementById('distanceText'); d.textContent = 'Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„ØªÙŠ Ù‚Ø·Ø¹ØªÙ‡Ø§: '+Math.floor(score)+' Ù…ØªØ±'; document.getElementById('gameOverOverlay').style.display='flex'; }

    function rectOverlap(x1,y1,w1,h1,x2,y2,w2,h2){ return !(x1+w1<x2 || x1>x2+w2 || y1+h1<y2 || y1>y2+h2); }

    // ===== Ø±Ø³Ù… =====
    function draw(){
      const W=canvas.width, H=canvas.height;
      ctx.clearRect(0,0,W,H);
      // Ø³Ù…Ø§Ø¡
      const g=ctx.createLinearGradient(0,0,0,H); g.addColorStop(0,'#c5dcff'); g.addColorStop(1,'#f5f9ff'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
      // Ø·Ø±ÙŠÙ‚ + Ø¸Ù„ Ø¨Ø³ÙŠØ·
      ctx.fillStyle='#e6e6e6'; ctx.fillRect(0,H-groundH,W,groundH);
      ctx.fillStyle='rgba(0,0,0,.08)'; ctx.fillRect(0,H-groundH,W,6);

      // Ø¹Ù‚Ø¨Ø§Øª
      ctx.fillStyle='#555'; for(const o of obstacles){ ctx.fillRect(o.x,o.y,o.w,o.h); }

      // Ø§Ù„Ù„Ø§Ø¹Ø¨ (ÙˆØ¬Ù‡ Ø¯Ø§Ø¦Ø±ÙŠ) + Ø¯ÙˆØ±Ø§Ù† Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØª
      ctx.save(); ctx.translate(player.x+player.w/2, player.y+player.h/2); ctx.rotate(player.angle); ctx.beginPath(); ctx.arc(0,0,player.w/2,0,Math.PI*2); ctx.closePath(); ctx.clip();
      if(face.complete) ctx.drawImage(face,-player.w/2,-player.h/2,player.w,player.h); else { ctx.fillStyle='#ddd'; ctx.fillRect(-player.w/2,-player.h/2,player.w,player.h); }
      ctx.restore();

      // HUD
      ctx.fillStyle='#222'; ctx.font='bold 18px Cairo, sans-serif'; ctx.fillText('Ø§Ù„Ù…Ø³Ø§ÙØ©: '+Math.floor(score)+' Ù…', 14, 28);
    }

    // ===== Ù„ÙˆØ¨ =====
    function loop(ts){ const dt = (ts-last)/1000 || 0; last=ts; update(dt); draw(); requestAnimationFrame(loop); }
    requestAnimationFrame(loop);

    // ===== ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù =====
    const startOverlay=document.getElementById('startOverlay');
    const gameOverOverlay=document.getElementById('gameOverOverlay');
    document.getElementById('startBtn').onclick=()=>{ startOverlay.style.display='none'; state='play'; reset(); music.currentTime=0; music.play(); };
    document.getElementById('okBtn').onclick=()=>{ gameOverOverlay.style.display='none'; state='play'; reset(); music.currentTime=0; music.play(); };
  </script>
</body>
</html>
